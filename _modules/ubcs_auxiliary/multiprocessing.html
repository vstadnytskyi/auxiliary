

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ubcs_auxiliary.multiprocessing &mdash; UBCS LCP auxiliary package library 0.post10.dev0+ga92bbf3 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> UBCS LCP auxiliary package library
          

          
          </a>

          
            
            
              <div class="version">
                0.post10.dev0+ga92bbf3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../multiprocessing.html">Multiprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../saved-property.html">Saved Property</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../save-load-object.html">Save Load Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../numerical.html">Numerical Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release-history.html">Release History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../min_versions.html">Minimum Version of Python and NumPy</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">UBCS LCP auxiliary package library</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>ubcs_auxiliary.multiprocessing</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for ubcs_auxiliary.multiprocessing</h1><div class="highlight"><pre>
<div class="viewcode-block" id="new_child_process"><a class="viewcode-back" href="../../usage.html#ubcs_auxiliary.multiprocessing.new_child_process">[docs]</a><span></span><span class="k">def</span> <span class="nf">new_child_process</span><span class="p">(</span><span class="n">function</span><span class="p">,</span>  <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    launches the input &#39;function&#39; in a separate thread with daemon == True.</span>

<span class="sd">    Explanation: Some threads do background tasks, like sending keepalive packets, or performing periodic garbage collection, or whatever. These are only useful when the main program is running, and it&#39;s okay to kill them off once the other, non-daemon, threads have exited.</span>

<span class="sd">    Without daemon threads, you&#39;d have to keep track of them, and tell them to exit, before your program can completely quit. By setting them as daemon threads, you can let them run and forget about them, and when your program quits, any daemon threads are killed automatically.</span>
<span class="sd">    @Chris Jester-Young https://stackoverflow.com/a/190017/8436767</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    function:</span>
<span class="sd">        function object</span>
<span class="sd">    *args:</span>
<span class="sd">        iterable of arguments</span>
<span class="sd">    **kwargs:</span>
<span class="sd">        dictionary of keywords</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    process:</span>
<span class="sd">        process object</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    the example of usage</span>

<span class="sd">    &gt;&gt;&gt; def func(*args,**kwargs):</span>
<span class="sd">            print(&#39;keywords&#39;,kwargs)</span>
<span class="sd">            print(&#39;args&#39;,args)</span>
<span class="sd">            from time import time,sleep</span>
<span class="sd">            t1 = time()</span>
<span class="sd">            sleep(args[0])</span>
<span class="sd">            t2 = time()</span>
<span class="sd">            print(&#39;this thread slept for {} seconds&#39;.format(t2-t1))</span>
<span class="sd">            print(&#39;input parameters: args = {}, kwargs = {!r}&#39;.format(args[0],kwargs[&#39;keyword&#39;]))</span>
<span class="sd">    &gt;&gt;&gt; new_child_process(func, 1, keyword = &#39;this is key 1 value&#39;)</span>
<span class="sd">    this thread slept for 1.002244234085083 seconds</span>
<span class="sd">    input parameters: args = 1, kwargs = &#39;keywords argument&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Process</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">function</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">p</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">p</span></div>

<span class="k">class</span> <span class="nc">ParallelProcessing</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="nb">iter</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is a specialized wrapper around multiprocessing.Process object. It</span>
<span class="sd">        launches multiple separate processes with the same input &#39;function&#39; but different argument that comes from an iterable object like tuple or list.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        function :: function</span>
<span class="sd">            function object</span>
<span class="sd">        args :: list or tuple</span>
<span class="sd">            iterable of arguments</span>
<span class="sd">        kwargs :: dictionary</span>
<span class="sd">            keyword arguments that will be passed to the function</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        jobs :: list</span>
<span class="sd">            list of jobs</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; mp = ParallelProcessing(function, (1,2,3))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Process</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">function</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">arg</span><span class="p">,),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">p</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">p</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

<div class="viewcode-block" id="MultiProcessing"><a class="viewcode-back" href="../../multiprocessing.html#ubcs_auxiliary.multiprocessing.MultiProcessing">[docs]</a><span class="k">class</span> <span class="nc">MultiProcessing</span><span class="p">():</span>
<div class="viewcode-block" id="MultiProcessing.__init__"><a class="viewcode-back" href="../../multiprocessing.html#ubcs_auxiliary.multiprocessing.MultiProcessing.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is a specialized wrapper around multiprocessing.Process object. It</span>
<span class="sd">        launches multiple separate processes with the same input &#39;function&#39; but different argument that comes from an iterable object like tuple or list.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        function :: function</span>
<span class="sd">            function object</span>
<span class="sd">        args :: list or tuple</span>
<span class="sd">            iterable of arguments</span>
<span class="sd">        kwargs :: dictionary</span>
<span class="sd">            keyword arguments that will be passed to the function</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        jobs :: list</span>
<span class="sd">            list of jobs</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; mp = ParallelProcessing(function, (1,2,3))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Process</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">function</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">arg</span><span class="p">,),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">p</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="kn">import</span> <span class="nn">warnings</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;MultuProcessing class will be deprecated in future versions. The new name is ParallelProcessing&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="function"><a class="viewcode-back" href="../../usage.html#ubcs_auxiliary.multiprocessing.function">[docs]</a><span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    an example function for test purposes. It sleeps for N seconds. Prints statements when sleep starts and finishes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span><span class="p">,</span> <span class="n">sleep</span>

    <span class="n">print_text_kwarg</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">print_dict_kwarg</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">print_var_kwarg</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Starting Process&#39;</span><span class="p">)</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> s] Start sleeping for </span><span class="si">{}</span><span class="s1"> seconds&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t1</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">N</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> s] Sleeping... &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t1</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
    <span class="n">sleep</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> s] Done sleeping for </span><span class="si">{}</span><span class="s1"> seconds&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t1</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">N</span><span class="p">))</span></div>

<span class="k">def</span> <span class="nf">print_text_kwarg</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;kwarg text = </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">print_dict_kwarg</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;kwarg dict = </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;dict&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">print_var_kwarg</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;kwarg var = </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="test"><a class="viewcode-back" href="../../usage.html#ubcs_auxiliary.multiprocessing.test">[docs]</a><span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    simple test showing how to use</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s1">&#39;my new text&#39;</span><span class="p">,</span> <span class="s1">&#39;var&#39;</span> <span class="p">:</span> <span class="mf">15.64</span><span class="p">,</span> <span class="s1">&#39;dict&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;key&#39;</span><span class="p">:</span><span class="s1">&#39;my new value&#39;</span><span class="p">}}</span>
    <span class="n">mp</span> <span class="o">=</span> <span class="n">MultiProcessing</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="test2"><a class="viewcode-back" href="../../usage.html#ubcs_auxiliary.multiprocessing.test2">[docs]</a><span class="k">def</span> <span class="nf">test2</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    simple test showing how to use</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s1">&#39;my new text&#39;</span><span class="p">,</span> <span class="s1">&#39;var&#39;</span> <span class="p">:</span> <span class="mf">15.64</span><span class="p">,</span> <span class="s1">&#39;dict&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;key&#39;</span><span class="p">:</span><span class="s1">&#39;my new value&#39;</span><span class="p">}}</span>
    <span class="n">mp</span> <span class="o">=</span> <span class="n">ParallelProcessing</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">)</span></div>

<span class="k">def</span> <span class="nf">test3</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">120</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span><span class="p">,</span> <span class="n">ctime</span><span class="p">,</span> <span class="n">sleep</span>
    <span class="kn">import</span> <span class="nn">os</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="p">())</span><span class="o">+</span><span class="s1">&#39;.txt&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">root</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
    <span class="n">t_start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="k">while</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t_start</span> <span class="o">&lt;=</span><span class="n">t</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ctime</span><span class="p">(</span><span class="n">time</span><span class="p">()))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the process is done&#39;</span><span class="p">)</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019, Valentyn Stadnytskyi

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>